
<div class="panel panel-default">
			<div class="panel-heading">METADATO
				<p style="float: right"><%= link_to_remove_tag_fields "rimuovi", f.object.id %></p>
        <%= f.hidden_field :mark_for_destruction, :value => false %>
			</div>
		<div class="panel-body">

				<div class="col-lg-10 metadata-form-container">
					<div class="row" style="margin-bottom: 0px;">
						<div class="col-lg-6">
							<div class="form-group">
								<label class="text-input">Nome campo</label>
						  		<%= f.text_field :name, :class => "form-control" %>
							</div>
						</div>
						<div class="col-lg-6">
							<div class="form-group">
							  <label class="text-input">Tipo</label>
							   <%= f.select(:field_type, [["STRINGA", "STRINGA"], ["MEDIA", "UPLOAD"]], {}, { :class => "form-control meta-type", :onchange => "changeMetadataType(this);" }) %>
							</div>
						</div>
					</div>
					<div class="row string-metadata">
						<div class="col-lg-12">
							<div class="form-group">
								<label class="text-input">Valore</label>
						  		<%= f.text_area :value, :class => "form-control", :size => "60x10" %>
							</div>
						</div>
					</div>
					<div class="row media-metadata">
						<div class="col-lg-6 text-center">

				          <% if f.object.id && f.object.upload %>
				          <div class="form-group">
				              <label class="text-input">Media</label>
				              <div class="fileupload fileupload-new" data-provides="fileupload">
				                <div class="fileupload-preview thumbnail" style="width: 400px; height: 300px; line-height: 20px;">
				                	<img src="<%= f.object.upload.url %>">
				                </div>
				                <div>
				                  <span class="btn btn-default btn-file"><span class="fileupload-new">SELEZIONA L'IMMAGINE</span>
				                  <span class="fileupload-exists">Change</span><%= f.file_field :upload  %></span>
				                  <a href="#" class="btn btn-default fileupload-exists" data-dismiss="fileupload">Remove</a>
				                </div>
				              </div>
				          </div>
				          <% else %>
				          <div class="form-group">
				              <label class="text-input">Media</label>
				              <div class="fileupload fileupload-new" data-provides="fileupload">
				                <div class="fileupload-preview thumbnail" style="width: 400px; height: 300px; line-height: 20px;"></div>
				                <div>
				                  <span class="btn btn-default btn-file"><span class="fileupload-new">SELEZIONA L'IMMAGINE</span>
				                  <span class="fileupload-exists">Change</span><%= f.file_field :upload  %></span>
				                  <a href="#" class="btn btn-default fileupload-exists" data-dismiss="fileupload">Remove</a>
				                </div>
				              </div>
				          </div>
				          <% end %>
						</div>
					</div>
			</div>
  	</div>

</div>
<style>
	.media-metadata{ display: none; }
</style>
<script type="text/javascript">
	
	$(document).ready(function(){
		$(".metadata-form-container").each(function(index){
			select = $(this).find("select.meta-type");
			changeMetadataType(select);
		});
	});
	
	function getSelectValue(select){
		return $(select).find("option:selected").val();
	}
	
	function changeMetadataType(type_element){
		var value = getSelectValue(type_element);
		if(value == "UPLOAD"){
			$(type_element).parents(".metadata-form-container").find(".string-metadata").hide();
			$(type_element).parents(".metadata-form-container").find(".media-metadata").show();
		}else{
			$(type_element).parents(".metadata-form-container").find(".media-metadata").hide();
			$(type_element).parents(".metadata-form-container").find(".string-metadata").show();
		}
	}
</script>