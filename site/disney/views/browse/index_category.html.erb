<div class="container container--default" ng-controller="BrowseCtrl" ng-init="init(<%= @category.to_json %>, <%= @contents.to_json %>, <%= @tags.to_json %>)">
	<div class="row category-header">
    <img ng-src="{{category.header_image_url}}" class="img-responsive category-header__header-image" />
  	<h1 class="category-header__title">{{category.title}}</h1>
  	<div class="category-header__filter-area">
      <button class="btn btn-primary" ng-click="isTagFilterOpen = !isTagFilterOpen">
        <span class="glyphicon glyphicon-chevron-down" style="position: relative; top: 3px;"></span>
          Filtra
      </button>
    </div>
  </div>
  <div class="row text-center">
    <div class="col-xs-12">
			<div collapse="!isTagFilterOpen" class="row category-filter main-row">
				<div ng-repeat="(tag_id, tag_name) in tags" class="col-sm-2 col-xs-6 category-filter__col">
					<button class="category-filter__btn btn btn-xs btn-default category-filter__tag" ng-class="{ 'category-filter__tag--disabled': tagsEnabled[tag_id] == undefined, 'btn-dark-blue': activeTags[tag_id] != undefined }" ng-disabled="tagsEnabled[tag_id] == undefined" ng-click="tagSelected(tag_id)">
            {{tag_name}}<span class="fa fa-remove" ng-if="activeTags[tag_id] != undefined"></span>
          </button>
				</div> 
			</div>
		</div>
  </div>

  <div class="row main-row">
    <!-- ORDER FILTER -->
    <div class="col-md-12 text-right" style="margin-top: 15px; margin-bottom: 15px;">
      <div class="dropdown">
        <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
          <span class="glyphicon glyphicon-chevron-down" style="position: relative; top: 3px;"></span>
          Ordina
        </button>
        <ul class="dropdown-menu dropdown-menu-right text-left" role="menu" aria-labelledby="dropdownMenu1">
          <li class="active" role="presentation"><a role="menuitem" href="javascript: void(0)" ng-click="order('created_at',false)">Pi√π recenti</a></li>
          <li role="presentation"><a role="menuitem" href="javascript: void(0)" ng-click="order('title',false)">Titolo</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row main-row brws-item">
    <div class="col-md-12">
     
	      <div class="row">
      		<div class="col-xs-12 col-md-3" ng-repeat="content in visibleElements">
				<%= light_link_to("{{content.detail_url}}") do %>	
		        <div class="relateds-flexslider__item-panel relateds-flexslider__item-panel--full-search" ng-if="content.type == 'cta'"> 
		          <div class="row">
		            <div class="col-xs-12">
		              <div class="relateds-flexslider__thumbnail">
		                <img class="img-responsive cta-preview__image" ng-src="{{content.thumb_url}}">            
		                <!-- STATUS -->
		                <div class="col-sm-12  cta-cover__winnable-reward text-right" ng-if="content.status != undefined">
											<span class="label label-warning cta-cover__winnable-reward__label">+{{content.status.winnable_reward_count}}<span class="cta-cover__glyphicon-icon fa fa-star"></span></span>
										</div>
		
		              </div>
		              <p class="cta-preview__title">{{content.title | cut:true:40}}</p>
		            </div>
		          </div>
		          <div class="row relateds-flexslider__footer">
		            <div class="col-xs-12">
		              <p class="relateds-flexslider__likes"><span class="fa fa-thumbs-up relateds-flexslider__thumbs-up"></span>{{content.likes}}</p>
		              <p class="relateds-flexslider__comments"><span class="glyphicon glyphicon-comment relateds-flexslider__glyphicon-comment"></span>{{content.comments}}</p>
		            </div>
		          </div>
		        </div>
		        <div class="relateds-flexslider__item-panel relateds-flexslider__item-panel--full-search" ng-if="content.type == 'tag'" style="background-image: url('{{content.thumb_url}}'); background-position: center center; background-size: auto 100%;"> 
		            <div class="row">
		              <div class="col-xs-12 text-center cta-preview--tag">
		                <p class="cta-preview__title--tag">{{content.title | cut:true:40}}</p>
		              </div>
		            </div>
		          </div> 
		      <% end %>
			</div>
			
			<div class="col-xs-4 col-xs-offset-4">
				<a class="btn btn-primary btn-block btn-load-more" ng-click="load_more(elements_in_page)">Carica Altri</a>
			</div>

	      </div>
	  </div>
   </div>
</div>
