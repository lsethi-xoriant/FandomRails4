<div class="container-fluid">
  <div class="row">
    <div class="col-xs-12 col-lg-8 col-lg-offset-2 col-md-6 col-md-offset-3">

      <% if current_user %>
        <% if @calltoactions.any? %>
          <div id="home-carousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <% if @calltoactions.count > 1 %>
                <% @calltoactions.each_with_index do |calltoaction, i| %>
                  <li data-target="#home-carousel" data-slide-to="0" class="<%= "active" if i == 0 %>"></li>
                <% end %>
              <% end %>
            </ol>
            <div class="carousel-inner">
              <% @calltoactions.each_with_index do |calltoaction, i| %>
                <div class="item <%= "active" if i == 0 %>" style="background: url('<%= calltoaction.thumbnail %>') no-repeat center top; background-size: cover;">


                  <div class="container">

                    <div class="carousel-caption" style="top: 0;">
                      <div class="col-xs-12 text-right">
                        <h4>
                          <% if call_to_action_completed?(calltoaction) %>
                            <span id="head-feedback-calltoaction-<%= calltoaction.id %>" class="label label-success" style="padding-top: 5px;">
                              FATTO <span class="glyphicon glyphicon-ok"></span>
                            </span>
                          <% else %>
                            <span id="head-feedback-calltoaction-<%= calltoaction.id %>" class="label label-warning" style="padding-top: 5px;">+<%= @calltoaction_reward_status[calltoaction.id][:winnable_reward_count] %>
                              <span class="glyphicon glyphicon-star"></span>
                            </span>
                          <% end %>
                        </h4>
                      </div>
                    </div>

                    <div class="carousel-caption" style="bottom: 0; top: initial;">
                      <div class="col-xs-8 col-xsm-12 text-left">
                        <h5 class="text-with-shadow">
                          <% tags_with_miniformat_in_calltoaction = get_tag_with_tag_about_call_to_action(calltoaction, "miniformat") %>
                          <% if tags_with_miniformat_in_calltoaction.any? %>
                            <span class="<%= tags_with_miniformat_in_calltoaction.first.tag_fields.find_by_name("icon").try(:value) %>"></span>
                            <%= tags_with_miniformat_in_calltoaction.first.tag_fields.find_by_name("title").try(:value) %>
                          <% else %>
                            &nbsp;
                          <% end %>
                        </h5>      
                        <h2 class="text-with-shadow" style="margin-top: 0px;"><%= calltoaction.title %></h2>
                      </div>
                      <div class="col-xs-4 col-xsm-12 margin-top-sm-10"><h2><button class="btn-2" role="button" onclick="window.top.location.href = '<%= @stream_url %>';">GUARDA</button></h2></div>   
                    </div>


                  </div>
                </div>
              <% end %>
            </div>
            <% if @calltoactions.count > 1 %>
              <a class="left carousel-control" href="#home-carousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
              <a class="right carousel-control" href="#home-carousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
            <% end %>
          </div>
        <% end %>
      <% else %>
        <% if @active_home_launchers.any? %>
          <div id="home-carousel" class="carousel slide" data-ride="carousel">
            <!-- Indicators -->
            <ol class="carousel-indicators">
              <% if @active_home_launchers.count > 1 %>
                <% @active_home_launchers.each_with_index do |home_launcher, i| %>
                  <li data-target="#home-carousel" data-slide-to="0" class="<%= "active" if i == 0 %>"></li>
                <% end %>
              <% end %>
            </ol>
            <div class="carousel-inner">
              <% @active_home_launchers.each_with_index do |home_launcher, i| %>
                <div class="item <%= "active" if i == 0 %>" style="background: url('<%= home_launcher.image %>') no-repeat center top; background-size: cover;">
                  <div class="container">
                    <div class="carousel-caption" style="left: 10%; bottom: 15px; top: initial;">
                      <div class="row">
                        <div class="col-xs-8 text-left">    
                          <h2 class="text-with-shadow"><%= home_launcher.description %></h2>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-xs-3 text-left">
                          <h2><button class="btn-2" role="button" onclick="window.top.location.href = '<%= home_launcher.url %>';"><%= home_launcher.button %></button></h2>
                        </div>
                      </div>   
                    </div>
                  </div>
                </div>
              <% end %>
            </div>
            <% if @active_home_launchers.count > 1 %>
              <a class="left carousel-control" href="#home-carousel" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a>
              <a class="right carousel-control" href="#home-carousel" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
            <% end %>
          </div>
        <% end %>
      <% end %>
        

    </div>
  </div>
</div>